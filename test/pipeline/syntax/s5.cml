/*
 * Side-Effect Synchronization
 */

module main

sync func modify(var x: int) {
    x = x + 1
}

func fetch_data(): int sync {
    let i = 0
    wait modify(i)
    return i
}

func main(): int sync {
    print("before start")
    sleep(1000)
    print("after start")
    return fetch_data()
}
 